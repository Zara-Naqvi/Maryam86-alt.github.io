<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zaheer Abbas | Deputy IT Manager</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Google Fonts: Playfair Display for the name, Inter for everything else -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        /* Custom styles to apply the specific fonts and aesthetic */
        body {
            font-family: 'Inter', sans-serif;
            /* ENHANCED BACKGROUND FOR MAGIC EFFECT */
            background: radial-gradient(circle at 50% 10%, #ffffff 0%, #f0f0f0 80%);
            min-height: 100vh;
        }

        .header-name {
            font-family: 'Playfair Display', serif;
            letter-spacing: 0.05em;
        }

        /* Utility for the subtle shadow/glow on cards and buttons */
        .soft-card {
            background-color: rgba(220, 220, 220, 0.8); /* Light gray with slight transparency */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(2px);
        }
        
        /* Style for all content blocks on the skills page to ensure clear visual separation and prevent overlap */
        .content-block {
            /* Use a clear white background with a shadow for definition */
            @apply bg-white p-6 rounded-3xl shadow-xl transition duration-300;
        }

        /* Style for highlighted headings on the details page */
        .highlighted-heading {
            /* Enhanced visibility for the main category headers */
            @apply text-xl font-bold text-gray-800 pt-1 pb-2; /* Adjusted padding slightly */
        }

        .nav-button {
            transition: all 0.2s;
            cursor: pointer;
        }

        .nav-button:hover {
            background-color: rgba(189, 189, 189, 0.9);
            transform: translateY(-2px);
        }

        .profile-img-container {
            /* Mimics the slight shadow/border effect in the original image */
            box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.8), 0 0 10px rgba(0, 0, 0, 0.2);
            padding: 2px;
            background-color: white;
        }
        
        /* NO CUSTOM BOLDING OR HIGHLIGHTING STYLES REMAIN */
        
        /* Transition for the video link hover effect */
        #video-link, #skill-audio-icon, #work-audio-icon {
            transition: color 0.2s;
        }
        #video-link:hover .text-gray-700 {
            color: #4a5568; /* Darker gray on hover */
        }
        #video-link:hover .bg-gray-500 {
            background-color: #4a5568;
        }

        /* Spinning animation for loading */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .animate-spin-slow {
            animation: spin 3s linear infinite;
        }

        /* --- MAGICAL REVEAL ANIMATION --- */
        @keyframes reveal-magic {
            0% {
                opacity: 0;
                transform: translateY(15px) scale(0.98);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .animate-reveal {
            animation: reveal-magic 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
            opacity: 0; /* Start hidden */
        }

        /* Pre-defined delays for staggered effect */
        .delay-1 { animation-delay: 0.1s; }
        .delay-2 { animation-delay: 0.3s; }
        .delay-3 { animation-delay: 0.5s; }
        .delay-4 { animation-delay: 0.7s; }
        .delay-5 { animation-delay: 0.9s; }
        .delay-6 { animation-delay: 1.1s; }
        .delay-7 { animation-delay: 1.3s; }
        
        /* Custom list style for Page 2 */
        .skill-list {
            list-style: none; /* Removing default disc */
            padding-left: 0; 
            line-height: 1.5;
            margin-top: 0.5rem;
            font-size: 0.9rem; /* Slightly smaller text for list items */
        }
        .skill-list li:before {
            content: 'â€¢'; /* Use a simple bullet point */
            margin-right: 0.5rem;
            font-weight: bold;
            color: #4b5563; /* Gray-600 */
        }
        /* Style for the back to home button */
        .home-button {
            background-color: #e5e7eb; /* Gray-200 */
            color: #1f2937; /* Gray-800 */
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: 600;
            transition: all 0.2s;
        }
        .home-button:hover {
            background-color: #d1d5db; /* Gray-300 */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Specific styles for the two-column layout on the skills/certs page */
        #skills-content-container, #certs-content-container {
            display: grid;
            grid-template-columns: 1fr; /* Single column on mobile */
            gap: 20px;
        }
        @media (min-width: 768px) {
            #skills-content-container, #certs-content-container {
                grid-template-columns: 1fr 1fr; /* Two columns on desktop/tablet */
                gap: 40px;
            }
        }
        
        /* New style for the image container blocks. 
           Added 'overflow-hidden' to ensure rounded corners on the image. */
        .image-placeholder-block {
            /* Ensures it's centered and capped in size, and acts as a frame */
            @apply w-full h-auto rounded-xl flex items-center justify-center text-gray-500 text-sm italic overflow-hidden;
            min-height: 250px; /* Enforce a minimum height for visibility */
        }
        .image-placeholder-block img {
             /* Ensure image takes up all available space in its block */
            width: 100%;
            height: 100%;
        }
        
        /* Style for the clickable audio icon on the skills page */
        #skill-audio-icon, #work-audio-icon {
            cursor: pointer;
            transition: opacity 0.2s, transform 0.2s;
        }
        #skill-audio-icon:hover, #work-audio-icon:hover {
            opacity: 1;
            transform: scale(1.05);
        }
        .audio-playing {
            color: #10b981; /* Emerald green for active state */
            transform: scale(1.1);
        }

        /* Specific styling for the message box for better error visibility */
        #message-box {
            z-index: 1000;
            white-space: nowrap;
        }
        
        /* Custom list style for Work Experience - using a dash for the achievements list */
        .work-achievements li:before {
            content: '-';
            margin-right: 0.5rem;
            font-weight: bold;
            color: #4b5563;
        }

    </style>
</head>
<body class="p-4 sm:p-8 flex justify-center items-start">

    <!-- Main Content Wrapper -->
    <div class="w-full max-w-4xl text-center">

        <!-- ============================================== -->
        <!-- 1. HOME PAGE CONTENT (Default View) -->
        <!-- ============================================== -->
        <div id="home-page" class="w-full">
            <!-- Header Name -->
            <h1 class="header-name text-7xl sm:text-8xl font-medium text-gray-800 mt-8 mb-4 animate-reveal delay-1">
                Zaheer Abbas
            </h1>

            <!-- Profile Image & Video Icon Container (Flex to align icon and image horizontally) -->
            <div class="flex justify-center items-center mb-10 animate-reveal delay-2">
                
                <!-- Video Play Icon Link -->
                <a href="#" id="video-link" class="flex items-center w-24 sm:w-32 mr-4 justify-end cursor-pointer">
                    
                    <!-- Loading/Play Icon Container -->
                    <div id="video-icon-container" class="order-2 transition-colors duration-200">
                        <!-- Default Play Icon -->
                        <svg id="play-icon" class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.799v4.394a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <!-- Loading Spinner -->
                        <svg id="loading-spinner" class="hidden w-6 h-6 text-gray-500 animate-spin-slow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                    </div>

                    <!-- Horizontal Line -->
                    <div class="flex-grow h-px bg-gray-500 order-1 mr-2 transition-colors duration-200"></div>
                </a>

                <!-- Profile Image Container -->
                <div class="profile-img-container rounded-full overflow-hidden w-40 h-40">
                    <img 
                        src="profile.jpg" 
                        alt="Zaheer Abbas Profile" 
                        class="object-cover w-full h-full"
                        onerror="this.onerror=null;this.src='https://placehold.co/160x160/374151/ffffff?text=Profile+Error';"
                    >
                </div>

                <!-- Placeholder for right side symmetry (empty space) -->
                <div class="w-24 sm:w-32 ml-4"></div>
            </div>

            <!-- Job Title -->
            <h2 class="text-xl sm:text-2xl font-bold tracking-widest text-gray-700 mb-10 animate-reveal delay-3">
                DEPUTY IT MANAGER FOR INFRASTRUCTURE
            </h2>

            <!-- About Section (The main card) -->
            <div class="soft-card p-6 sm:p-10 rounded-3xl mx-auto max-w-3xl mb-12 animate-reveal delay-4">
                <p id="profile-bio" class="text-gray-700 text-sm sm:text-base leading-relaxed">
                    Hello, I am Zaheer Abbas. As a seasoned Deputy IT Manager for Infrastructure with over 14 years of experience, I leverage my expertise in managing complex IT environments to drive innovation and excellence in higher education and public sectors. With a strong background in Linux systems, virtualization technologies, and networking, I excel in leading data center operations, infrastructure planning, and service delivery while prioritizing automation, resilience, and compliance. Currently serving at the University of Oxford, I bring technical leadership and strategic vision to the table, supported by professional certifications including PRINCE2, ITIL, RHCSA, and CEH.
                </p>
            </div>

            <!-- "Know more about me" Heading -->
            <h3 class="text-xl sm:text-2xl font-semibold text-gray-800 mb-8 mt-12 animate-reveal delay-5">
                Know more about me
            </h3>

            <!-- Navigation Buttons -->
            <div class="flex flex-wrap justify-center gap-4 sm:gap-6 px-4 mb-16 animate-reveal delay-6">
                <button id="skills-btn" data-content="skills" class="nav-button soft-card text-xs sm:text-sm font-bold uppercase tracking-wider text-gray-700 py-3 px-6 rounded-full">
                    Key Skills & Tools
                </button>
                <button id="certs-btn" data-content="certs" class="nav-button soft-card text-xs sm:text-sm font-bold uppercase tracking-wider text-gray-700 py-3 px-6 rounded-full">
                    Certifications & Trainings
                </button>
                <button id="work-btn" data-content="work" class="nav-button soft-card text-xs sm:text-sm font-bold uppercase tracking-wider text-gray-700 py-3 px-6 rounded-full">
                    Work Experience
                </button>
                <button id="edu-btn" data-content="education" class="nav-button soft-card text-xs sm:text-sm font-bold uppercase tracking-wider text-gray-700 py-3 px-6 rounded-full">
                    Education
                </button>
            </div>

            <!-- Contact Button -->
            <button id="contact-btn" class="nav-button soft-card text-base font-semibold text-gray-800 py-4 px-12 rounded-full mb-12 animate-reveal delay-7">
                Contact Me
            </button>
        </div>


        <!-- ============================================== -->
        <!-- 2. DETAILS PAGE CONTENT (Hidden by default) -->
        <!-- ============================================== -->
        <div id="details-page" class="hidden w-full px-4 sm:px-0 text-left">
            
            <header id="details-header" class="flex justify-between items-start mb-8 sm:mb-12">
                <!-- This title remains and is sufficient -->
                <h1 id="details-title" class="header-name text-4xl sm:text-5xl font-medium text-gray-800 leading-tight tracking-wider">
                    KEY SKILLS AND TOOLS
                </h1>
                <button id="back-home-btn" class="home-button transition duration-300 flex-shrink-0 mt-2">
                    <!-- Icon for Home -->
                    <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                    Home
                </button>
            </header>

            <div id="details-content" class="text-gray-700">
                
                <!-- CONTENT FOR KEY SKILLS AND TOOLS -->
                <div id="skills-content" class="w-full">
                    
                    <!-- Separator line with play icon -->
                    <div class="flex items-center mb-10">
                        <!-- Clickable Audio Icon for Skills List -->
                        <div id="skill-audio-icon" class="flex items-center w-8 cursor-pointer opacity-70 flex-shrink-0">
                            <!-- Default Play Icon (used when paused/ready) -->
                            <svg id="skill-play-icon" class="w-4 h-4 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.799v4.394a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg>
                             <!-- Loading Spinner for Skills Audio -->
                            <svg id="skill-loading-spinner" class="hidden w-4 h-4 text-gray-500 animate-spin-slow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                        </div>
                        <div class="flex-grow h-px bg-gray-500 ml-1 mr-4"></div>
                    </div>

                    <!-- Two-Column Grid Structure -->
                    <div id="skills-content-container">
                        
                        <!-- LEFT COLUMN CONTENT: space-y-6 provides equal gap between all skill-block divs -->
                        <div class="space-y-6">

                            <!-- 1. Leadership & People Management (Text Block) -->
                            <div class="skill-block content-block">
                                <h3 class="highlighted-heading">
                                    <span class="border-b-2 border-gray-400 pb-1">Leadership & People Management</span>
                                </h3>
                                <div class="text-sm">
                                    <p class="font-bold mb-2">Proven leader with expertise in:</p>
                                    <ul id="list-1" class="skill-list">
                                        <li>Team leadership and coaching</li>
                                        <li>Recruitment and onboarding</li>
                                        <li>Regular 1:1s and performance reviews</li>
                                        <li>Mentoring with personalized skill development plans</li>
                                        <li>Effective stakeholder and supplier management</li>
                                        <li>Budget management (Â£300k to Â£500k)</li>
                                        <li>Risk-informed decision-making</li>
                                        <li>Strategic planning and prioritization (Kanban)</li>
                                        <li>Incident leadership and problem resolution</li>
                                        <li>CAB and change approvals</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <!-- 2. UNIX & Platform Operations (Image Block - paragraph2.jpg) -->
                            <div class="skill-block content-block">
                                <div class="image-placeholder-block mb-0">
                                    <img 
                                        src="paragraph2.jpg" 
                                        alt="Linux and Virtualization illustration" 
                                        class="w-full h-full object-cover" 
                                        onerror="this.onerror=null;this.closest('.image-placeholder-block').innerHTML='<div class=\'p-4 text-center\'>Image Load Failed: paragraph2.jpg</div>';"
                                    >
                                </div>
                            </div>

                            <!-- 3. Automation & DevOps (Text Block) -->
                            <div class="skill-block content-block">
                                <h3 class="highlighted-heading">
                                    <span class="border-b-2 border-gray-400 pb-1">Automation & DevOps</span>
                                </h3>
                                <div class="text-sm mb-4">
                                    <p class="font-bold mb-2">Configuration Management:</p>
                                    <ul id="list-3" class="skill-list">
                                        <li>Configuration management: Uyuni, Salt, Ansible</li>
                                        <li>Version control: Git</li>
                                        <li>Load balancing: HAProxy with keepalived</li>
                                        <li>Infrastructure as code: Configuration as code practices</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <!-- 4. Monitoring, Security & Compliance (Text Block) -->
                            <div class="skill-block content-block">
                                <h3 class="highlighted-heading">
                                    <span class="border-b-2 border-gray-400 pb-1">Monitoring, Security & Compliance</span>
                                </h3>
                                <div class="text-sm">
                                    <ul id="list-4" class="skill-list">
                                        <li>Monitoring tools: Zabbix, Grafana, ELK</li>
                                        <li>Security tools: Wazuh, auditd, Fail2ban, ModSecurity</li>
                                        <li>Firewall management: iptables, nftables</li>
                                        <li>Compliance frameworks: CIS, NIST, SANS</li>
                                    </ul>
                                </div>
                            </div>

                        </div> <!-- End Left Column -->

                        <!-- RIGHT COLUMN CONTENT: space-y-6 provides equal gap between all skill-block divs -->
                        <div class="space-y-6">
                            
                            <!-- 1. Leadership & People Management (Image Block - paragraph1.jpg) -->
                            <div class="skill-block content-block"> 
                                <div class="image-placeholder-block">
                                    <img 
                                        src="paragraph1.jpg" 
                                        alt="Team Leadership illustration" 
                                        class="w-full h-full object-cover" 
                                        onerror="this.onerror=null;this.closest('.image-placeholder-block').innerHTML='<div class=\'p-4 text-center\'>Image Load Failed: paragraph1.jpg</div>';"
                                    >
                                </div>
                            </div>

                            <!-- 2. UNIX & Platform Operations (Text Block) -->
                            <div class="skill-block content-block">
                                <h3 class="highlighted-heading">
                                    <span class="border-b-2 border-gray-400 pb-1">UNIX & Platform Operations</span>
                                </h3>
                                <div class="text-sm">
                                    <p class="font-bold mb-2">Expertise in:</p>
                                    <ul id="list-2" class="skill-list">
                                        <li>Linux distributions: RHEL, AlmaLinux, Ubuntu, Debian</li>
                                        <li>Identity and access management: FreeIPA, LDAP, Kerberos, SSSD</li>
                                        <li>Web servers: Nginx, Apache</li>
                                        <li>System administration: systemd, SELinux</li>
                                        <li>Virtualization: VMware vSphere, Hyper-V</li>
                                        <li>Scripting and automation: Bash, Python</li>
                                        <li>Containerization: Docker, k3s</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <!-- 3. Automation & DevOps / Monitoring & Security (Image Block - paragraph3.jpg) -->
                            <div class="skill-block content-block"> 
                                <div class="image-placeholder-block">
                                    <img 
                                        src="paragraph3.jpg" 
                                        alt="DevOps Pipeline illustration" 
                                        class="w-full h-full object-cover" 
                                        onerror="this.onerror=null;this.closest('.image-placeholder-block').innerHTML='<div class=\'p-4 text-center\'>Image Load Failed: paragraph3.jpg</div>';"
                                >
                                </div>
                            </div>

                            <!-- 4. Networking & Cloud (Text Block - Now Separate) -->
                            <div class="skill-block content-block">
                                <h3 class="highlighted-heading">
                                    <span class="border-b-2 border-gray-400 pb-1">Networking & Cloud</span>
                                </h3>
                                <div class="text-sm">
                                    <ul id="list-5" class="skill-list">
                                        <li>Network infrastructure: Cisco, HPE Aruba switching</li>
                                        <li>Firewalls: Palo Alto</li>
                                        <li>Network services: VLANs, routing, ACLs, DNS, DHCP, IPAM</li>
                                        <li>Cloud platforms: Azure, AWS, OpenStack</li>
                                        <li>Network security: pfSense, Mikrotik</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <!-- 5. Storage & Backup (Text Block - Now Separate) -->
                            <div class="skill-block content-block">
                                <h3 class="highlighted-heading">
                                    <span class="border-b-2 border-gray-400 pb-1">Storage & Backup</span>
                                </h3>
                                <div class="text-sm">
                                    <ul id="list-6" class="skill-list">
                                        <li>Storage systems: NetApp ONTAP (capacity, snapshots, quotas), NAS platforms</li>
                                        <li>Backup solutions: Veeam, IBM HFS</li>
                                    </ul>
                                </div>
                            </div>

                        </div> <!-- End Right Column -->

                    </div> <!-- End Two-Column Grid -->
                </div>
                
                <!-- CONTENT FOR CERTIFICATIONS AND TRAININGS (Page 3) -->
                <div id="certs-content" class="hidden">
                    
                    <!-- Separator line -->
                    <div class="flex items-center mb-10">
                        <!-- Empty div for symmetry of the line start, as there is no audio icon here -->
                        <div class="w-8 flex-shrink-0"></div> 
                        <div class="flex-grow h-px bg-gray-500 mr-4"></div>
                    </div>
                    
                    <!-- NEW Two-Column Grid Structure for Certs -->
                    <div id="certs-content-container" class="grid grid-cols-1 md:grid-cols-2 gap-10">
                        
                        <!-- LEFT COLUMN: Professional Certifications -->
                        <div class="space-y-6">

                            <!-- Block 1: Professional Certifications List -->
                            <div class="skill-block content-block">
                                <h3 class="highlighted-heading">
                                    <span class="border-b-2 border-gray-400 pb-1">Professional Certifications</span>
                                </h3>
                                <div class="text-sm">
                                    <p class="font-bold mb-2">Key formal qualifications:</p>
                                    <ul class="skill-list">
                                        <li>PRINCE2 Foundation: Project Management</li>
                                        <li>ITIL Foundation v3: IT Service Management</li>
                                        <li>RHCSA (Red Hat Certified System Administrator): Linux System Administration</li>
                                        <li>CEH (Certified Ethical Hacker): Cybersecurity principles</li>
                                    </ul>
                                </div>
                            </div>

                            <!-- Block 2: Image Placeholder for Certs -->
                            <div class="skill-block content-block">
                                <div class="image-placeholder-block mb-0">
                                    <img 
                                        src="cert-image.jpg" 
                                        alt="Certifications illustration" 
                                        class="w-full h-full object-cover" 
                                        onerror="this.onerror=null;this.closest('.image-placeholder-block').innerHTML='<div class=\'p-4 text-center\'>Image Load Failed: cert-image.jpg</div>';"
                                    >
                                </div>
                            </div>

                        </div> <!-- End Left Column -->

                        <!-- RIGHT COLUMN: Specialized Training & Courses -->
                        <div class="space-y-6">

                            <!-- Block 1: Specialized Training & Courses List -->
                            <div class="skill-block content-block">
                                <h3 class="highlighted-heading">
                                    <span class="border-b-2 border-gray-400 pb-1">Specialized Training & Courses</span>
                                </h3>
                                <div class="text-sm">
                                    <p class="font-bold mb-2">Focused training programs:</p>
                                    <ul class="skill-list">
                                        <li>Advanced Linux Administration & Troubleshooting</li>
                                        <li>VMware vSphere Deployment and Management</li>
                                        <li>Data Center Operations Management</li>
                                        <li>Cloud Security Principles (Azure/AWS)</li>
                                        <li>Network Troubleshooting and Diagnostics (Cisco/Palo Alto)</li>
                                        <li>Scripting for Automation (Python/Bash)</li>
                                    </ul>
                                </div>
                            </div>

                            <!-- Block 2: Image Placeholder for Training -->
                            <div class="skill-block content-block">
                                <div class="image-placeholder-block mb-0">
                                    <img 
                                        src="training-image.jpg" 
                                        alt="Training illustration" 
                                        class="w-full h-full object-cover" 
                                        onerror="this.onerror=null;this.closest('.image-placeholder-block').innerHTML='<div class=\'p-4 text-center\'>Image Load Failed: training-image.jpg</div>';"
                                    >
                                </div>
                            </div>

                        </div> <!-- End Right Column -->

                    </div> <!-- End Grid Structure -->
                </div>
                
                <!-- CONTENT FOR WORK EXPERIENCE (Page 4) -->
                <div id="work-content" class="hidden">
                    
                    <!-- Separator line with play icon -->
                    <div class="flex items-center mb-10">
                        <!-- Clickable Audio Icon for Work Experience -->
                        <div id="work-audio-icon" class="flex items-center w-8 cursor-pointer opacity-70 flex-shrink-0">
                            <!-- Default Play Icon (used when paused/ready) -->
                            <svg id="work-play-icon" class="w-4 h-4 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.799v4.394a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg>
                             <!-- Loading Spinner for Work Audio -->
                            <svg id="work-loading-spinner" class="hidden w-4 h-4 text-gray-500 animate-spin-slow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                        </div>
                        <div class="flex-grow h-px bg-gray-500 ml-1 mr-4"></div>
                    </div>

                    <!-- Layout: Image on the right for desktop, content wrapper on the left (and full width on mobile) -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        
                        <!-- Main Content Card (Col 1 & 2 on desktop, full width on mobile) -->
                        <div class="md:col-span-2 space-y-6 order-2 md:order-1">
                            <!-- We wrap the main card in skill-block for the animation/delay to work -->
                            <div class="skill-block soft-card p-6 rounded-3xl text-sm leading-relaxed text-gray-700">
                                
                                <!-- Deputy IT Manager Role -->
                                <p class="mb-4">
                                    I'm Deputy IT Manager for Infrastructure at the University of Oxford's Computer Science Department. I've been in this role since August 2022, and my days are filled with excitement. I lead infrastructure strategy and operations across two datacenters to ensure our systems are running smoothly. I manage a talented team of Linux and Windows system administrators, and we've achieved some amazing things together.
                                </p>

                                <!-- Background -->
                                <p class="mb-4">
                                    <span class="font-bold text-base">A bit about my background</span><br>
                                    Before joining Oxford, I worked at Harrow College as an IT Support Engineer and Lecturer, where I taught Level 3 Cyber Security and Big Data with a 95% pass rate. Prior to that, I was Deputy Executive Officer at Punjab Safe Cities Authority, where I managed a large-scale datacenter environment and implemented cutting-edge technologies.
                                </p>

                                <!-- Key Achievements -->
                                <p class="font-bold text-base mb-2">Some of my key achievements</p>
                                <ul class="work-achievements skill-list mb-4">
                                    <li>Migrated production systems from Centos 7 to AlmaLinux 8 with minimal downtime</li>
                                    <li>Rebuilt monitoring stack using ELK, Zabbix, and Grafana</li>
                                    <li>Deployed Uyuni with Salt states for automated patching and lifecycle management</li>
                                    <li>Implemented FreeIPA and Red Hat IDM for identity management and authentication</li>
                                </ul>

                                <!-- What I do / My Role -->
                                <p class="font-bold text-base mb-2">What I do</p>
                                <p>
                                    My role involves leading infrastructure strategy, managing a team, and overseeing our annual infrastructure budget of Â£300k - Â£500k. I'm also responsible for drafting our cyber security strategy and acting as a technical lead for core infrastructure.
                                </p>
                                
                            </div>
                        </div>
                        
                        <!-- Image Container (Col 3 on desktop, full width on mobile) -->
                        <div class="md:col-span-1 flex justify-center items-start order-1 md:order-2">
                            <div class="skill-block image-placeholder-block soft-card w-full h-auto rounded-3xl overflow-hidden shadow-xl">
                                <img 
                                    src="paragraph5.jpg" 
                                    alt="Zaheer Abbas working on a laptop in a garden setting" 
                                    class="w-full h-full object-cover" 
                                    onerror="this.onerror=null;this.closest('.image-placeholder-block').innerHTML='<div class=\'p-4 text-center\'>Image Load Failed: paragraph5.jpg</div>';"
                                >
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                <!-- CONTENT FOR EDUCATION (Page 5) -->
                <div id="education-content" class="hidden">
                    <p class="text-lg text-center py-20 soft-card p-8 rounded-xl">Education content goes here. Click the Home button to return.</p>
                </div>

            </div>
        </div>

        <!-- Message Box for simulating alerts and showing status -->
        <div id="message-box" class="fixed bottom-5 right-5 bg-gray-800 text-white p-4 rounded-lg shadow-2xl transition-opacity duration-300 opacity-0 pointer-events-none">
            Status: <span id="message-text"></span>
        </div>

    </div>

    <script>
        // === CRITICAL FIX: Ensure USER_API_KEY is an empty string for the environment to inject credentials ===
        const USER_API_KEY = ""; 
        
        // --- Global State for Page and Preloading ---
        let preloadedAudio = null; // Home page intro
        let isAudioReady = false;
        let currentPage = 'home'; // State: 'home' or 'details'
        let skillAudio = null; // Skills list audio
        let isSkillAudioLoading = false;
        let workAudio = null; // Work experience audio
        let isWorkAudioLoading = false;


        // DOM Elements
        const homePage = document.getElementById('home-page');
        const detailsPage = document.getElementById('details-page');
        const detailsTitle = document.getElementById('details-title');
        const detailsHeader = document.getElementById('details-header'); // New element to animate
        
        const videoLink = document.getElementById('video-link');
        const playIcon = document.getElementById('play-icon');
        const loadingSpinner = document.getElementById('loading-spinner');
        const profileBioText = document.getElementById('profile-bio').textContent.replace(/\s+/g, ' ').trim(); 
        
        const skillAudioIcon = document.getElementById('skill-audio-icon');
        const skillPlayIcon = document.getElementById('skill-play-icon');
        const skillLoadingSpinner = document.getElementById('skill-loading-spinner');
        
        // NEW Work Experience Audio Elements
        const workAudioIcon = document.getElementById('work-audio-icon');
        const workPlayIcon = document.getElementById('work-play-icon');
        const workLoadingSpinner = document.getElementById('work-loading-spinner');


        // --- Content Map for Page 2 ---
        const contentMap = {
            'skills': { 
                title: 'KEY SKILLS AND TOOLS', 
                elementId: 'skills-content' 
            },
            'certs': { 
                title: 'CERTIFICATIONS & TRAININGS', 
                elementId: 'certs-content' 
            },
            'work': { 
                title: 'WORK EXPERIENCE', 
                elementId: 'work-content' 
            },
            'education': { 
                title: 'EDUCATION', 
                elementId: 'education-content' 
            }
        };

        // --- Utility Functions ---
        function base64ToArrayBuffer(base64) {
            const binaryString = atob(base64);
            const len = binaryString.length;
            const bytes = new Uint8Array(len);
            for (let i = 0; i < len; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            return bytes.buffer;
        }

        function pcmToWav(pcm16, sampleRate = 24000) {
            const numChannels = 1;
            const bitsPerSample = 16;
            const blockAlign = numChannels * (bitsPerSample / 8);
            const byteRate = sampleRate * blockAlign;
            const dataSize = pcm16.length * 2; 

            const buffer = new ArrayBuffer(44 + dataSize);
            const dataView = new DataView(buffer);

            let offset = 0;
            function writeString(s) {
                for (let i = 0; i < s.length; i++) {
                    dataView.setUint8(offset++, s.charCodeAt(i));
                }
            }
            writeString('RIFF');
            dataView.setUint32(offset, 36 + dataSize, true); offset += 4;
            writeString('WAVE');
            writeString('fmt ');
            dataView.setUint32(offset, 16, true); offset += 4; 
            dataView.setUint16(offset, 1, true); offset += 2;  
            dataView.setUint16(offset, numChannels, true); offset += 2;
            dataView.setUint32(offset, sampleRate, true); offset += 4;
            dataView.setUint32(offset, byteRate, true); offset += 4;
            dataView.setUint16(offset, blockAlign, true); offset += 2;
            dataView.setUint16(offset, bitsPerSample, true); offset += 2;
            writeString('data');
            dataView.setUint32(offset, dataSize, true); offset += 4;

            for (let i = 0; i < pcm16.length; i++) {
                dataView.setInt16(offset, pcm16[i], true);
                offset += 2;
            }
            return new Blob([dataView], { type: 'audio/wav' });
        }
        
        // Simple function to display a status message
        function showMessage(text, isError = false) {
            const messageBox = document.getElementById('message-box');
            const messageText = document.getElementById('message-text');

            messageText.textContent = text;
            messageBox.classList.remove('opacity-0', 'pointer-events-none', 'bg-red-600', 'bg-gray-800');
            
            messageBox.classList.add('opacity-100', isError ? 'bg-red-600' : 'bg-gray-800'); 

            // Auto-hide after 5 seconds unless it's an error
            if (!isError) {
                setTimeout(() => {
                    messageBox.classList.remove('opacity-100');
                    messageBox.classList.add('opacity-0', 'pointer-events-none');
                }, 5000);
            }
        }
        
        /**
         * GLOBAL FIX: Stops all playing audio, resets the play position, and updates the UI icons.
         * This function ensures no audio carries over between page views.
         */
        function stopAllAudio() {
            // Stop Home Intro Audio
            if (preloadedAudio && !preloadedAudio.paused) {
                preloadedAudio.pause();
                preloadedAudio.currentTime = 0;
            }
            
            // Stop Skills List Audio and reset state
            if (skillAudio && !skillAudio.paused) {
                skillAudio.pause();
                skillAudio.currentTime = 0;
            }
            // Stop Work Experience Audio and reset state
            if (workAudio && !workAudio.paused) {
                workAudio.pause();
                workAudio.currentTime = 0;
            }

            // Ensure the visual state is always reset here
            skillAudioIcon.classList.remove('audio-playing'); 
            workAudioIcon.classList.remove('audio-playing'); 
            
            // Ensure visual icons are reset
            loadingSpinner.classList.add('hidden');
            playIcon.classList.remove('hidden');
            skillLoadingSpinner.classList.add('hidden');
            skillPlayIcon.classList.remove('hidden');
            workLoadingSpinner.classList.add('hidden');
            workPlayIcon.classList.remove('hidden');
            
            // Reset loading state just in case
            isSkillAudioLoading = false;
            isWorkAudioLoading = false;
            skillAudioIcon.classList.remove('opacity-50', 'pointer-events-none');
            workAudioIcon.classList.remove('opacity-50', 'pointer-events-none');
        }


        // Generic API Caller with exponential backoff
        async function callTtsApi(payload, elementToSpin, elementToDisplay) {
            
            const maxRetries = 3;
            // Constructs the API URL
            let apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${USER_API_KEY}`;
            
            elementToDisplay.classList.add('hidden');
            elementToSpin.classList.remove('hidden');

            for (let attempt = 0; attempt < maxRetries; attempt++) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    
                    if (!response.ok) {
                        const errorDetails = await response.text();
                        console.error(`Attempt ${attempt + 1} failed with HTTP Status ${response.status}:`, errorDetails.substring(0, 200));
                        if (response.status === 401) {
                             throw new Error("Authorization Failed (401). Check API key setup in the environment.");
                        }
                        throw new Error(`API Request Failed (Status: ${response.status}).`);
                    }

                    const result = await response.json();
                    const part = result?.candidates?.[0]?.content?.parts?.[0];
                    const audioData = part?.inlineData?.data;
                    const mimeType = part?.inlineData?.mimeType;
                    
                    if (audioData && mimeType && mimeType.startsWith("audio/L16")) {
                        const sampleRate = 24000;
                        const pcmData = base64ToArrayBuffer(audioData);
                        const pcm16 = new Int16Array(pcmData);
                        const wavBlob = pcmToWav(pcm16, sampleRate);
                        const audioUrl = URL.createObjectURL(wavBlob);
                        
                        elementToSpin.classList.add('hidden');
                        elementToDisplay.classList.remove('hidden');
                        
                        return new Audio(audioUrl); 
                    } else {
                        // Log unexpected response structure
                        console.error("Received unexpected API response structure:", JSON.stringify(result));
                        throw new Error("Invalid audio response format received from API. Check console for details.");
                    }
                } catch (error) {
                    if (attempt < maxRetries - 1) {
                        const delay = Math.pow(2, attempt) * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                        continue; // Skip to the next attempt
                    } else {
                         // Final failure, clean up UI state and re-throw error
                         elementToSpin.classList.add('hidden');
                         elementToDisplay.classList.remove('hidden');
                         throw error;
                    }
                }
            }
            return null;
        }


        // --- Audio Logic (Home Page Bio) ---

        // 1. Function to pre-load the audio when the page loads
        async function preloadAudioIntroduction() {
            // Initial UI state: Disable link and show spinner
            videoLink.classList.add('opacity-50', 'pointer-events-none');
            
            let timeoutMessage = setTimeout(() => {
                showMessage('Pre-loading audio introduction (reading full bio)... This may take a moment.', false);
            }, 3000); 

            // Text preparation for pronunciation
            let speechText = document.getElementById('profile-bio').textContent.replace(/\s+/g, ' ').trim(); 
            
            speechText = speechText
                .replace(/Deputy IT Manager for Infrastructure/g, "Deputy I. T. Manager for Infrastructure")
                .replace(/PRINCE2/g, "Prince two")
                .replace(/ITIL/g, "I. T. I. L.")
                .replace(/RHCSA/g, "R. H. C. S. A.")
                .replace(/CEH/g, "C. E. H.");
                
            const userPrompt = speechText;
            
            const payload = {
                contents: [{ parts: [{ text: userPrompt }] }],
                generationConfig: {
                    responseModalities: ["AUDIO"],
                    speechConfig: {
                        voiceConfig: { prebuiltVoiceConfig: { voiceName: "Charon" } } // Male, Informative voice
                    }
                },
                model: "gemini-2.5-flash-preview-tts"
            };
            
            try {
                preloadedAudio = await callTtsApi(payload, loadingSpinner, playIcon);
                if (preloadedAudio) {
                    isAudioReady = true;
                    clearTimeout(timeoutMessage);
                    videoLink.classList.remove('opacity-50', 'pointer-events-none');
                    showMessage('Audio Introduction Ready! Click to play.', false);
                } else {
                    throw new Error("Preload function returned null audio (API call failed or returned empty response).");
                }
            } catch (error) {
                clearTimeout(timeoutMessage);
                
                // Explicitly log and display the error message
                console.error("CRITICAL AUDIO PRELOAD ERROR:", error);
                showMessage(`Audio Preload Failed. Critical error: ${error.message}`, true);
                videoLink.classList.remove('opacity-50', 'pointer-events-none'); // Re-enable link if failed
            }
        }

        // 2. Function to play the pre-loaded audio instantly on click
        function playIntroduction() {
            if (isAudioReady && preloadedAudio) {
                // Stop any other audio just in case
                stopAllAudio();
                
                preloadedAudio.currentTime = 0;
                preloadedAudio.play();
                showMessage('Playing full introduction instantly!', false);

                preloadedAudio.onended = () => {
                    document.getElementById('message-box').classList.remove('opacity-100');
                    document.getElementById('message-box').classList.add('opacity-0', 'pointer-events-none');
                };
            } else {
                showMessage('Status: Audio is still loading or a critical error occurred during preloading.', true);
            }
        }


        // --- Audio Logic (Skills Page List) ---
        
        async function speakAllSkills() {
            const isVisuallyPlaying = skillAudioIcon.classList.contains('audio-playing');

            // 1. **STOP/PAUSE LOGIC (NEW, HIGHER RELIABILITY):**
            if (isVisuallyPlaying) {
                if (skillAudio) {
                    skillAudio.pause();
                    skillAudio.currentTime = 0;
                }
                skillAudioIcon.classList.remove('audio-playing');
                showMessage('Skills list audio **paused** and reset.');
                return; 
            }
            
            // 2. RESUME/REPLAY LOGIC
            if (skillAudio && skillAudio.paused) {
                skillAudio.play();
                skillAudioIcon.classList.add('audio-playing');
                showMessage('Skills list audio **resumed** playing.');

                skillAudio.onended = () => {
                    skillAudioIcon.classList.remove('audio-playing');
                };
                return; 
            }

            // 3. BLOCKED/LOADING LOGIC
            if (isSkillAudioLoading) {
                showMessage('Audio is currently being generated. Please wait...', false);
                return;
            }
            
            // --- GENERATION LOGIC ---

            // Stop other audio playback
            stopAllAudio();
            
            const contentContainer = document.getElementById('skills-content-container');
            let combinedText = "Here is a summary of my key skills and tools: ";

            const textElements = contentContainer.querySelectorAll('.skill-block h3, .skill-block p, .skill-block li');

            textElements.forEach(element => {
                let text = element.textContent.trim();

                if (!text || element.closest('.image-placeholder-block')) return; 

                // Replace abbreviations for better pronunciation
                text = text.replace(/1:1s/g, "one on one meetings"); 
                text = text.replace(/(\Â£\s*\d+\w+\s*to\s*\Â£\s*\d+\w+)/g, match => match.replace('Â£', ' ').replace('k', ' thousand pounds to ').replace('k', ' thousand pounds ')); 
                text = text.replace(/(\Â£\s*\d+\w+)/g, match => match.replace('Â£', ' ').replace('k', ' thousand pounds '));
                text = text.replace(/k3s/g, "K three S");
                text = text.replace(/pfSense/g, "P F sense");
                text = text.replace(/RHEL/g, "Red Hat Enterprise Linux");
                text = text.replace(/RHCSA/g, "R H C S A");
                text = text.replace(/CEH/g, "C. E. H.");
                text = text.replace(/ITIL/g, "I. T. I. L.");


                if (element.tagName === 'H3') {
                    combinedText += `\n\nSection: ${text}. `; 
                } else if (element.tagName === 'P') {
                    combinedText += `${text}. `;
                } else if (element.tagName === 'LI') {
                    combinedText += `${text}, `;
                }
            });
            
            combinedText = combinedText.replace(/, \./g, '.');

            // 4. Set loading state
            isSkillAudioLoading = true;
            skillAudioIcon.classList.add('opacity-50', 'pointer-events-none');
            
            const userPrompt = combinedText;

            showMessage('Generating comprehensive audio for all skill descriptions...', false);

            const payload = {
                contents: [{ parts: [{ text: userPrompt }] }],
                generationConfig: {
                    responseModalities: ["AUDIO"],
                    speechConfig: {
                        voiceConfig: { prebuiltVoiceConfig: { voiceName: "Charon" } } 
                    }
                },
                model: "gemini-2.5-flash-preview-tts"
            };
            
            try {
                skillAudio = await callTtsApi(payload, skillLoadingSpinner, skillPlayIcon);
                
                if (skillAudio) {
                    skillAudio.play();
                    skillAudioIcon.classList.add('audio-playing');
                    showMessage('Skills summary audio ready and playing!', false);
                    skillAudio.onended = () => {
                        skillAudioIcon.classList.remove('audio-playing');
                    };
                }
            } catch (error) {
                console.error("Failed to generate skills audio:", error);
                showMessage(`Skills audio generation failed: ${error.message}`, true);
            } finally {
                isSkillAudioLoading = false;
                skillAudioIcon.classList.remove('opacity-50', 'pointer-events-none');
            }
        }


        // --- Audio Logic (Work Experience Page) ---
        async function speakWorkExperience() {
            const isVisuallyPlaying = workAudioIcon.classList.contains('audio-playing');

            // 1. **STOP/PAUSE LOGIC**
            if (isVisuallyPlaying) {
                if (workAudio) {
                    workAudio.pause();
                    workAudio.currentTime = 0;
                }
                workAudioIcon.classList.remove('audio-playing');
                showMessage('Work experience audio **paused** and reset.');
                return; 
            }
            
            // 2. RESUME/REPLAY LOGIC
            if (workAudio && workAudio.paused) {
                workAudio.play();
                workAudioIcon.classList.add('audio-playing');
                showMessage('Work experience audio **resumed** playing.');
                workAudio.onended = () => {
                    workAudioIcon.classList.remove('audio-playing');
                };
                return; 
            }

            // 3. BLOCKED/LOADING LOGIC
            if (isWorkAudioLoading) {
                showMessage('Audio is currently being generated. Please wait...', false);
                return;
            }
            
            // --- GENERATION LOGIC ---

            // Stop other audio playback
            stopAllAudio();

            // 4. Gather all text content
            const contentContainer = document.getElementById('work-content');
            let combinedText = "My professional experience: ";

            const textElements = contentContainer.querySelectorAll('.skill-block p, .skill-block li');

            textElements.forEach(element => {
                let text = element.textContent.trim();
                
                if (!text || element.closest('.image-placeholder-block')) return; 

                // Replace abbreviations, LaTeX, and currency for better pronunciation
                text = text.replace(/IT Manager for Infrastructure/g, "I. T. Manager for Infrastructure"); 
                text = text.replace(/Level 3 Cyber Security/g, "Level three Cyber Security"); 
                text = text.replace(/95\%/g, "95 percent"); 
                text = text.replace(/IDM/g, "I. D. M.");
                text = text.replace(/(\Â£\s*\d+\w+\s*-\s*\Â£\s*\d+\w+)/g, match => match.replace('Â£', ' ').replace('k', ' thousand pounds to ').replace('k', ' thousand pounds ')); 
                text = text.replace(/ELK/g, "E. L. K.");
                
                if (element.tagName === 'P') {
                    // Check if it's a bold title line, and if so, add extra pause
                    if (element.querySelector('strong')) {
                         combinedText += `\n\n${text}. `;
                    } else {
                        combinedText += `${text}. `;
                    }
                } else if (element.tagName === 'LI') {
                    combinedText += `${text}, `;
                }
            });
            
            combinedText = combinedText.replace(/, \./g, '.');

            // 5. Set loading state
            isWorkAudioLoading = true;
            workAudioIcon.classList.add('opacity-50', 'pointer-events-none');
            
            const userPrompt = combinedText;

            showMessage('Generating audio for Work Experience...', false);

            const payload = {
                contents: [{ parts: [{ text: userPrompt }] }],
                generationConfig: {
                    responseModalities: ["AUDIO"],
                    speechConfig: {
                        voiceConfig: { prebuiltVoiceConfig: { voiceName: "Charon" } } 
                    }
                },
                model: "gemini-2.5-flash-preview-tts"
            };
            
            try {
                workAudio = await callTtsApi(payload, workLoadingSpinner, workPlayIcon);
                
                if (workAudio) {
                    workAudio.play();
                    workAudioIcon.classList.add('audio-playing');
                    showMessage('Work Experience audio ready and playing!', false);
                    workAudio.onended = () => {
                        workAudioIcon.classList.remove('audio-playing');
                    };
                }
            } catch (error) {
                console.error("Failed to generate work experience audio:", error);
                showMessage(`Work experience audio generation failed: ${error.message}`, true);
            } finally {
                isWorkAudioLoading = false;
                workAudioIcon.classList.remove('opacity-50', 'pointer-events-none');
            }
        }


        // --- NEW FUNCTION: Trigger Reveal Animation on Detail Page Content ---
        function triggerDetailsAnimation(targetContentElement) {
            // 1. Identify all key elements to animate, including the header
            const animatableElements = [
                detailsHeader, // The page header (title & back button)
                // Select all content blocks inside the target element
                ...targetContentElement.querySelectorAll('.skill-block') 
            ];
            
            // 2. Remove all animation classes to reset the animation state
            animatableElements.forEach(el => {
                el.classList.remove('animate-reveal', 'delay-1', 'delay-2', 'delay-3', 'delay-4', 'delay-5', 'delay-6');
                el.style.opacity = '0'; // Ensure it starts hidden for the quick re-flow
            });
            
            // CRITICAL: Force reflow/repaint to ensure the animation is re-triggered
            void detailsPage.offsetHeight; 

            // 3. Re-add animation classes with staggered delays
            animatableElements.forEach((el, index) => {
                // Adjust delay to start later for the main content blocks after the header
                const adjustedIndex = index + 1; 
                const delayClass = `delay-${Math.min(adjustedIndex, 6)}`; 
                el.classList.add('animate-reveal', delayClass);
            });
        }
        // --- END NEW FUNCTION ---


        // --- Page Switching Logic ---
        function setView(page) {
            // CRITICAL FIX: Stop all audio whenever the view changes (Issue #1)
            stopAllAudio(); 
            
            if (page === 'home') {
                homePage.classList.remove('hidden');
                detailsPage.classList.add('hidden');
                currentPage = 'home';
                window.scrollTo(0, 0); // Scroll to top of the home page
                
            } else if (page === 'details') {
                homePage.classList.add('hidden');
                detailsPage.classList.remove('hidden');
                currentPage = 'details';
                window.scrollTo(0, 0); // Scroll to top of the new page
            }
        }

        function navigateTo(target) {
            // CRITICAL FIX: Stop all audio before navigating to a new details page
            stopAllAudio();

            const contentInfo = contentMap[target];
            if (!contentInfo) {
                showMessage(`Error: Content target '${target}' not found.`, true);
                return;
            }

            // 1. Update Details Page Title
            detailsTitle.textContent = contentInfo.title;

            // 2. Switch all detail sections off, then switch the target one on
            let targetElement;
            Object.values(contentMap).forEach(info => {
                const element = document.getElementById(info.elementId);
                if (element) {
                    // Important: Hide all other content sections
                    element.classList.add('hidden'); 
                    if (info.elementId === contentInfo.elementId) {
                        targetElement = element;
                    }
                }
            });

            if (targetElement) {
                targetElement.classList.remove('hidden');
            }
            
            // 3. Switch the main view
            setView('details');

            // 4. Trigger the animation on the newly visible content
            if (targetElement) {
                triggerDetailsAnimation(targetElement); 
            }
            
            showMessage(`Displaying: ${contentInfo.title}`);
        }

        // --- Event Listeners ---

        // Home Bio Audio Playback
        document.getElementById('video-link').addEventListener('click', (e) => {
            e.preventDefault(); 
            playIntroduction();
        });
        
        // Skills List Audio Playback 
        document.getElementById('skill-audio-icon').addEventListener('click', speakAllSkills);

        // Work Experience Audio Playback
        document.getElementById('work-audio-icon').addEventListener('click', speakWorkExperience);


        // Navigation from Home Page Buttons
        document.querySelectorAll('#home-page button[data-content]').forEach(button => {
            button.addEventListener('click', (e) => {
                const target = e.currentTarget.getAttribute('data-content');
                navigateTo(target);
            });
            // Ensure the cursor pointer style is visible on the contact button
            if(button.id === 'contact-btn') {
                button.style.cursor = 'pointer';
            }
        });
        
        // Back to Home Button
        document.getElementById('back-home-btn').addEventListener('click', () => {
            setView('home');
            showMessage('Welcome back to the profile summary!');
        });

        // Contact Button Placeholder
        document.getElementById('contact-btn').addEventListener('click', () => {
            showMessage('Initiating Contact Me action...');
        });
        
        // --- Initialization: Start preloading the audio as soon as the window loads ---
        window.onload = function() {
            preloadAudioIntroduction();
            // Ensure we start on the home page view
            setView('home'); 
        };

    </script>
</body>
</html>
